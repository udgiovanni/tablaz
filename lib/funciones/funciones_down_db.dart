import 'package:sqlite3/sqlite3.dart';

class FuncionesDownDB {
  Future<bool> tablaZ(String ruta) async {
    bool existenciaTablaZ;
    try {
      final db = sqlite3.open('$ruta\\database.sqlite3');
      final ResultSet dataTablaZ =
          db.select('SELECT * FROM VW_TABLAZ ORDER BY CTACTO ASC LIMIT 1;');
      existenciaTablaZ = true;
    } catch (e) {
      existenciaTablaZ = false;
    }
    return existenciaTablaZ;
  }

  Future<List<List<dynamic>>> tablaZCSV(String ruta) async {
    final db = sqlite3.open('$ruta\\database.sqlite3');
    final ResultSet tablaz = db.select('SELECT * FROM VW_TABLAZ;');
    List<List<dynamic>> datosCSV = [];
    List<String> encabezado = [
      'CTACTO',
      'CTA_TIPO',
      'CTA_INTERNA',
      'CTA_EST_REGIONAL_1',
      'CTA_CLAUSO',
      'CTA_ESTRATO',
      'CTA_FAC_COLECTIVA',
      'CTA_DIR_CORRESP',
      'PORCION_CTACTO',
      'ESTREGIONAL_CTACTO_2',
      'CTA_MOTBLQREC',
      'CTA_MOTBLQFICA',
      'CTA_PET_BORRADO',
      'INSTALACION_AC',
      'SECTOR_AC',
      'ALTA_INS_AC',
      'BAJA_INS_AC',
      'INS_CLASE_CALCULO_AC',
      'INS_CLASE_TARIFA_AC',
      'INS_SOLSECTORIAL_AC',
      'INS_UNILECTURA_AC',
      'INS_CLASE_INSTALACION_AC',
      'INS_ZONA_TEMPERATURA_AC',
      'INS_GRP_VAL_CONCRETOS_AC',
      'INS_TARIFA_AC',
      'MOV_GRP_ESTADISTICA_AC',
      'MOV_FALTA_AC',
      'MOV_FBAJA_AC',
      'INS_VLR_OPERANDO_AC',
      'INS_OPERANDO_FINI_AC',
      'INS_OPERANDO_FFIN_AC',
      'INSTALACION_AL_1',
      'SECTOR_AL_1',
      'ALTA_INS_AL_1',
      'BAJA_INS_AL_1',
      'INS_CLASE_CALCULO_AL_1',
      'INS_CLASE_TARIFA_AL_1',
      'INS_SOLSECTORIAL_AL_1',
      'INS_UNILECTURA_AL_1',
      'INS_CLASE_INSTALACION_AL_1',
      'INS_ZONA_TEMPERATURA_AL_1',
      'INS_GRP_VAL_CONCRETOS_AL_1',
      'INS_TARIFA_AL_1',
      'MOV_GRP_ESTADISTICA_AL_1',
      'MOV_FALTA_AL_1',
      'MOV_FBAJA_AL_1',
      'INS_VLR_OPERANDO_AL_1',
      'INS_OPERANDO_FINI_AL_1',
      'INS_OPERANDO_FFIN_AL_1',
      'INSTALACION_AL_2',
      'SECTOR_AL_2',
      'ALTA_INS_AL_2',
      'BAJA_INS_AL_2',
      'INS_CLASE_CALCULO_AL_2',
      'INS_CLASE_TARIFA_AL_2',
      'INS_SOLSECTORIAL_AL_2',
      'INS_UNILECTURA_AL_2',
      'INS_CLASE_INSTALACION_AL_2',
      'INS_ZONA_TEMPERATURA_AL_2',
      'INS_GRP_VAL_CONCRETOS_AL_2',
      'INS_TARIFA_AL_2',
      'MOV_GRP_ESTADISTICA_AL_2',
      'MOV_FALTA_AL_2',
      'MOV_FBAJA_AL_2',
      'INS_VLR_OPERANDO_AL_2',
      'INS_OPERANDO_FINI_AL_2',
      'INS_OPERANDO_FFIN_AL_2',
      'PRM_PUNTO_SUMINISTRO',
      'PRM_TPO_PUNTO_CONSUMO',
      'PRM_AGREGACION',
      'PRM_UH',
      'PRM_UNH',
      'PRM_NRO_PERSONAS',
      'PRM_CHIP_CATASTRAL',
      'IND_RED_ASSIST',
      'IND_FAC_VIRTUAL',
      'NUM_PREDIO_NACIONAL',
      'LONGITUD',
      'LATITUD',
      'LOCALIDAD',
      'COB_OBJETO_CONEXION',
      'COB_CALLE',
      'COB_BARRIO',
      'COB_ESTREGIONAL',
      'COB_ZONA',
      'COB_DENOM_UBICACION',
      'COB_CALLE3',
      'COB_NUMERO_PLACA',
      'COB_POBLACION',
      'COD_REGION',
      'PAR_INTERLOCUTOR',
      'PAR_NME_EMPRESA',
      'PAR_CONCEP_BUSQUEDA',
      'PAR_TELEFONO',
      'PAR_NOMBRE',
      'PAR_APELLIDO',
      'PAR_CELULAR',
      'PAR_EMAIL',
      'PAR_TIPO_DOCUMENTO',
      'PAR_NRO_DOCUMENTO',
      'DEV_NRO_APARATO',
      'DEV_MARCA',
      'DEV_MATERIAL',
      'DEV_CENTRO_EMPLAZAMIENTO',
      'DEV_SERIAL_MEDIDOR',
      'DEV_TIPO',
      'DEV_STATUS',
      'DEV_GRP_PLANIFICACION',
      'DEV_FINI',
      'DEV_FFIN',
      'EVR_CONTRATO_AC',
      'EVR_SOCIEDAD_AC',
      'EVR_FAC_CONJUNTA_AC',
      'EVR_MOT_BLOQ_AC',
      'EVR_MOT_LIB_BLOQ_AC',
      'EVR_CENTRO_IMPUTACION_AC',
      'EVR_TRATAMIENTO_AC',
      'EVR_ULT_FACTURA_AC',
      'EVR_FALTA_AC',
      'EVR_FBAJA_AC',
      'EVR_CONTRATO_AL_1',
      'EVR_SOCIEDAD_AL_1',
      'EVR_FAC_CONJUNTA_AL_1',
      'EVR_MOT_BLOQ_AC:1',
      'EVR_MOT_LIB_BLOQ_AL_1',
      'EVR_CENTRO_IMPUTACION_AL_1',
      'EVR_TRATAMIENTO_AL_1',
      'EVR_ULT_FACTURA_AL_1',
      'EVR_FALTA_AL_1',
      'EVR_FBAJA_AL_1',
      'EVR_CONTRATO_AL_2',
      'EVR_SOCIEDAD_AL_2',
      'EVR_FAC_CONJUNTA_AL_2',
      'EVR_MOT_BLOQ_AC:2',
      'EVR_MOT_LIB_BLOQ_AL_2',
      'EVR_CENTRO_IMPUTACION_AL_2',
      'EVR_TRATAMIENTO_AL_2',
      'EVR_ULT_FACTURA_AC:1',
      'EVR_FALTA_AL_2',
      'EVR_FBAJA_AL_2',
      'FAC_COD_CONSUMO_1',
      'FAC_COD_CONSUMO_2',
      'FAC_COD_CONSUMO_3',
      'FAC_COD_CONSUMO_4',
      'FAC_COD_CONSUMO_5',
      'FAC_COD_CONSUMO_6',
      'FAC_CONSUMO_1',
      'FAC_CONSUMO_2',
      'FAC_CONSUMO_3',
      'FAC_CONSUMO_4',
      'FAC_CONSUMO_5',
      'FAC_CONSUMO_6',
      'FAC_CONS_PROM',
      'FAC_VIG_ACTUAL',
      'FAC_CONSUMO_PATRON',
      'FAC_LECTURA_ACT',
      'FAC_LECTURA_ANT'
    ];
    datosCSV.add(encabezado);
    for (final Row row in tablaz) {
      List<String> fila = [
        "${row['CTACTO']}",
        "${row['CTA_TIPO']}",
        "${row['CTA_INTERNA']}",
        "${row['CTA_EST_REGIONAL_1']}",
        "${row['CTA_CLAUSO']}",
        "${row['CTA_ESTRATO']}",
        "${row['CTA_FAC_COLECTIVA']}",
        "${row['CTA_DIR_CORRESP']}",
        "${row['PORCION_CTACTO']}",
        "${row['ESTREGIONAL_CTACTO_2']}",
        "${row['CTA_MOTBLQREC']}",
        "${row['CTA_MOTBLQFICA']}",
        "${row['CTA_PET_BORRADO']}",
        "${row['INSTALACION_AC']}",
        "${row['SECTOR_AC']}",
        "${row['ALTA_INS_AC']}",
        "${row['BAJA_INS_AC']}",
        "${row['INS_CLASE_CALCULO_AC']}",
        "${row['INS_CLASE_TARIFA_AC']}",
        "${row['INS_SOLSECTORIAL_AC']}",
        "${row['INS_UNILECTURA_AC']}",
        "${row['INS_CLASE_INSTALACION_AC']}",
        "${row['INS_ZONA_TEMPERATURA_AC']}",
        "${row['INS_GRP_VAL_CONCRETOS_AC']}",
        "${row['INS_TARIFA_AC']}",
        "${row['MOV_GRP_ESTADISTICA_AC']}",
        "${row['MOV_FALTA_AC']}",
        "${row['MOV_FBAJA_AC']}",
        "${row['INS_VLR_OPERANDO_AC']}",
        "${row['INS_OPERANDO_FINI_AC']}",
        "${row['INS_OPERANDO_FFIN_AC']}",
        "${row['INSTALACION_AL_1']}",
        "${row['SECTOR_AL_1']}",
        "${row['ALTA_INS_AL_1']}",
        "${row['BAJA_INS_AL_1']}",
        "${row['INS_CLASE_CALCULO_AL_1']}",
        "${row['INS_CLASE_TARIFA_AL_1']}",
        "${row['INS_SOLSECTORIAL_AL_1']}",
        "${row['INS_UNILECTURA_AL_1']}",
        "${row['INS_CLASE_INSTALACION_AL_1']}",
        "${row['INS_ZONA_TEMPERATURA_AL_1']}",
        "${row['INS_GRP_VAL_CONCRETOS_AL_1']}",
        "${row['INS_TARIFA_AL_1']}",
        "${row['MOV_GRP_ESTADISTICA_AL_1']}",
        "${row['MOV_FALTA_AL_1']}",
        "${row['MOV_FBAJA_AL_1']}",
        "${row['INS_VLR_OPERANDO_AL_1']}",
        "${row['INS_OPERANDO_FINI_AL_1']}",
        "${row['INS_OPERANDO_FFIN_AL_1']}",
        "${row['INSTALACION_AL_2']}",
        "${row['SECTOR_AL_2']}",
        "${row['ALTA_INS_AL_2']}",
        "${row['BAJA_INS_AL_2']}",
        "${row['INS_CLASE_CALCULO_AL_2']}",
        "${row['INS_CLASE_TARIFA_AL_2']}",
        "${row['INS_SOLSECTORIAL_AL_2']}",
        "${row['INS_UNILECTURA_AL_2']}",
        "${row['INS_CLASE_INSTALACION_AL_2']}",
        "${row['INS_ZONA_TEMPERATURA_AL_2']}",
        "${row['INS_GRP_VAL_CONCRETOS_AL_2']}",
        "${row['INS_TARIFA_AL_2']}",
        "${row['MOV_GRP_ESTADISTICA_AL_2']}",
        "${row['MOV_FALTA_AL_2']}",
        "${row['MOV_FBAJA_AL_2']}",
        "${row['INS_VLR_OPERANDO_AL_2']}",
        "${row['INS_OPERANDO_FINI_AL_2']}",
        "${row['INS_OPERANDO_FFIN_AL_2']}",
        "${row['PRM_PUNTO_SUMINISTRO']}",
        "${row['PRM_TPO_PUNTO_CONSUMO']}",
        "${row['PRM_AGREGACION']}",
        "${row['PRM_UH']}",
        "${row['PRM_UNH']}",
        "${row['PRM_NRO_PERSONAS']}",
        "${row['PRM_CHIP_CATASTRAL']}",
        "${row['IND_RED_ASSIST']}",
        "${row['IND_FAC_VIRTUAL']}",
        "${row['NUM_PREDIO_NACIONAL']}",
        "${row['LONGITUD']}",
        "${row['LATITUD']}",
        "${row['LOCALIDAD']}",
        "${row['COB_OBJETO_CONEXION']}",
        "${row['COB_CALLE']}",
        "${row['COB_BARRIO']}",
        "${row['COB_ESTREGIONAL']}",
        "${row['COB_ZONA']}",
        "${row['COB_DENOM_UBICACION']}",
        "${row['COB_CALLE3']}",
        "${row['COB_NUMERO_PLACA']}",
        "${row['COB_POBLACION']}",
        "${row['COD_REGION']}",
        "${row['PAR_INTERLOCUTOR']}",
        "${row['PAR_NME_EMPRESA']}",
        "${row['PAR_CONCEP_BUSQUEDA']}",
        "${row['PAR_TELEFONO']}",
        "${row['PAR_NOMBRE']}",
        "${row['PAR_APELLIDO']}",
        "${row['PAR_CELULAR']}",
        "${row['PAR_EMAIL']}",
        "${row['PAR_TIPO_DOCUMENTO']}",
        "${row['PAR_NRO_DOCUMENTO']}",
        "${row['DEV_NRO_APARATO']}",
        "${row['DEV_MARCA']}",
        "${row['DEV_MATERIAL']}",
        "${row['DEV_CENTRO_EMPLAZAMIENTO']}",
        "${row['DEV_SERIAL_MEDIDOR']}",
        "${row['DEV_TIPO']}",
        "${row['DEV_STATUS']}",
        "${row['DEV_GRP_PLANIFICACION']}",
        "${row['DEV_FINI']}",
        "${row['DEV_FFIN']}",
        "${row['EVR_CONTRATO_AC']}",
        "${row['EVR_SOCIEDAD_AC']}",
        "${row['EVR_FAC_CONJUNTA_AC']}",
        "${row['EVR_MOT_BLOQ_AC']}",
        "${row['EVR_MOT_LIB_BLOQ_AC']}",
        "${row['EVR_CENTRO_IMPUTACION_AC']}",
        "${row['EVR_TRATAMIENTO_AC']}",
        "${row['EVR_ULT_FACTURA_AC']}",
        "${row['EVR_FALTA_AC']}",
        "${row['EVR_FBAJA_AC']}",
        "${row['EVR_CONTRATO_AL_1']}",
        "${row['EVR_SOCIEDAD_AL_1']}",
        "${row['EVR_FAC_CONJUNTA_AL_1']}",
        "${row['EVR_MOT_BLOQ_AC:1']}",
        "${row['EVR_MOT_LIB_BLOQ_AL_1']}",
        "${row['EVR_CENTRO_IMPUTACION_AL_1']}",
        "${row['EVR_TRATAMIENTO_AL_1']}",
        "${row['EVR_ULT_FACTURA_AL_1']}",
        "${row['EVR_FALTA_AL_1']}",
        "${row['EVR_FBAJA_AL_1']}",
        "${row['EVR_CONTRATO_AL_2']}",
        "${row['EVR_SOCIEDAD_AL_2']}",
        "${row['EVR_FAC_CONJUNTA_AL_2']}",
        "${row['EVR_MOT_BLOQ_AC:2']}",
        "${row['EVR_MOT_LIB_BLOQ_AL_2']}",
        "${row['EVR_CENTRO_IMPUTACION_AL_2']}",
        "${row['EVR_TRATAMIENTO_AL_2']}",
        "${row['EVR_ULT_FACTURA_AC:1']}",
        "${row['EVR_FALTA_AL_2']}",
        "${row['EVR_FBAJA_AL_2']}",
        "${row['FAC_COD_CONSUMO_1']}",
        "${row['FAC_COD_CONSUMO_2']}",
        "${row['FAC_COD_CONSUMO_3']}",
        "${row['FAC_COD_CONSUMO_4']}",
        "${row['FAC_COD_CONSUMO_5']}",
        "${row['FAC_COD_CONSUMO_6']}",
        "${row['FAC_CONSUMO_1']}",
        "${row['FAC_CONSUMO_2']}",
        "${row['FAC_CONSUMO_3']}",
        "${row['FAC_CONSUMO_4']}",
        "${row['FAC_CONSUMO_5']}",
        "${row['FAC_CONSUMO_6']}",
        "${row['FAC_CONS_PROM']}",
        "${row['FAC_VIG_ACTUAL']}",
        "${row['FAC_CONSUMO_PATRON']}",
        "${row['FAC_LECTURA_ACT']}",
        "${row['FAC_LECTURA_ANT']}"
      ];
      datosCSV.add(fila);
    }
    return datosCSV;
  }
}
